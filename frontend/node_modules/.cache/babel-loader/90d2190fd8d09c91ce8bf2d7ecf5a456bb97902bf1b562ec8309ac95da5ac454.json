{"ast":null,"code":"import _objectSpread from\"/Users/vishesh/Downloads/HRApp 4/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useReducer,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();const initialState={user:null,token:localStorage.getItem('token'),isAuthenticated:false,loading:true};const authReducer=(state,action)=>{switch(action.type){case'LOGIN_SUCCESS':return _objectSpread(_objectSpread({},state),{},{user:action.payload.user,token:action.payload.token,isAuthenticated:true,loading:false});case'LOGOUT':return _objectSpread(_objectSpread({},state),{},{user:null,token:null,isAuthenticated:false,loading:false});case'SET_LOADING':return _objectSpread(_objectSpread({},state),{},{loading:action.payload});case'UPDATE_USER':return _objectSpread(_objectSpread({},state),{},{user:action.payload});default:return state;}};export const AuthProvider=_ref=>{let{children}=_ref;const[state,dispatch]=useReducer(authReducer,initialState);// Set auth token header\nconst setAuthToken=token=>{if(token){axios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);localStorage.setItem('token',token);}else{delete axios.defaults.headers.common['Authorization'];localStorage.removeItem('token');}};// Load user on app start\nuseEffect(()=>{const loadUser=async()=>{if(state.token){setAuthToken(state.token);try{const res=await axios.get('/api/auth/me');dispatch({type:'LOGIN_SUCCESS',payload:{user:res.data,token:state.token}});}catch(error){dispatch({type:'LOGOUT'});setAuthToken(null);}}else{dispatch({type:'SET_LOADING',payload:false});}};loadUser();},[state.token]);// Login user\nconst login=async(email,password)=>{try{const res=await axios.post('/api/auth/login',{email,password});const{token,user}=res.data;setAuthToken(token);dispatch({type:'LOGIN_SUCCESS',payload:{user,token}});return{success:true};}catch(error){var _error$response,_error$response$data;return{success:false,message:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Login failed'};}};// Register user\nconst register=async userData=>{try{const res=await axios.post('/api/auth/register',userData);const{token,user}=res.data;setAuthToken(token);dispatch({type:'LOGIN_SUCCESS',payload:{user,token}});return{success:true};}catch(error){var _error$response2,_error$response2$data;return{success:false,message:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Registration failed'};}};// Logout user\nconst logout=()=>{dispatch({type:'LOGOUT'});setAuthToken(null);};// Update user profile\nconst updateUser=userData=>{dispatch({type:'UPDATE_USER',payload:userData});};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user:state.user,token:state.token,isAuthenticated:state.isAuthenticated,loading:state.loading,login,register,logout,updateUser},children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","axios","jsx","_jsx","AuthContext","initialState","user","token","localStorage","getItem","isAuthenticated","loading","authReducer","state","action","type","_objectSpread","payload","AuthProvider","_ref","children","dispatch","setAuthToken","defaults","headers","common","concat","setItem","removeItem","loadUser","res","get","data","error","login","email","password","post","success","_error$response","_error$response$data","message","response","register","userData","_error$response2","_error$response2$data","logout","updateUser","Provider","value","useAuth","context","Error"],"sources":["/Users/vishesh/Downloads/HRApp 4/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst AuthContext = createContext();\r\n\r\nconst initialState = {\r\n  user: null,\r\n  token: localStorage.getItem('token'),\r\n  isAuthenticated: false,\r\n  loading: true\r\n};\r\n\r\nconst authReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'LOGIN_SUCCESS':\r\n      return {\r\n        ...state,\r\n        user: action.payload.user,\r\n        token: action.payload.token,\r\n        isAuthenticated: true,\r\n        loading: false\r\n      };\r\n    case 'LOGOUT':\r\n      return {\r\n        ...state,\r\n        user: null,\r\n        token: null,\r\n        isAuthenticated: false,\r\n        loading: false\r\n      };\r\n    case 'SET_LOADING':\r\n      return {\r\n        ...state,\r\n        loading: action.payload\r\n      };\r\n    case 'UPDATE_USER':\r\n      return {\r\n        ...state,\r\n        user: action.payload\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n\r\n  // Set auth token header\r\n  const setAuthToken = (token) => {\r\n    if (token) {\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n      localStorage.setItem('token', token);\r\n    } else {\r\n      delete axios.defaults.headers.common['Authorization'];\r\n      localStorage.removeItem('token');\r\n    }\r\n  };\r\n\r\n  // Load user on app start\r\n  useEffect(() => {\r\n    const loadUser = async () => {\r\n      if (state.token) {\r\n        setAuthToken(state.token);\r\n        try {\r\n          const res = await axios.get('/api/auth/me');\r\n          dispatch({\r\n            type: 'LOGIN_SUCCESS',\r\n            payload: { user: res.data, token: state.token }\r\n          });\r\n        } catch (error) {\r\n          dispatch({ type: 'LOGOUT' });\r\n          setAuthToken(null);\r\n        }\r\n      } else {\r\n        dispatch({ type: 'SET_LOADING', payload: false });\r\n      }\r\n    };\r\n\r\n    loadUser();\r\n  }, [state.token]);\r\n\r\n  // Login user\r\n  const login = async (email, password) => {\r\n    try {\r\n      const res = await axios.post('/api/auth/login', { email, password });\r\n      const { token, user } = res.data;\r\n      \r\n      setAuthToken(token);\r\n      dispatch({\r\n        type: 'LOGIN_SUCCESS',\r\n        payload: { user, token }\r\n      });\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        message: error.response?.data?.message || 'Login failed'\r\n      };\r\n    }\r\n  };\r\n\r\n  // Register user\r\n  const register = async (userData) => {\r\n    try {\r\n      const res = await axios.post('/api/auth/register', userData);\r\n      const { token, user } = res.data;\r\n      \r\n      setAuthToken(token);\r\n      dispatch({\r\n        type: 'LOGIN_SUCCESS',\r\n        payload: { user, token }\r\n      });\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        message: error.response?.data?.message || 'Registration failed'\r\n      };\r\n    }\r\n  };\r\n\r\n  // Logout user\r\n  const logout = () => {\r\n    dispatch({ type: 'LOGOUT' });\r\n    setAuthToken(null);\r\n  };\r\n\r\n  // Update user profile\r\n  const updateUser = (userData) => {\r\n    dispatch({ type: 'UPDATE_USER', payload: userData });\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user: state.user,\r\n        token: state.token,\r\n        isAuthenticated: state.isAuthenticated,\r\n        loading: state.loading,\r\n        login,\r\n        register,\r\n        logout,\r\n        updateUser\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}